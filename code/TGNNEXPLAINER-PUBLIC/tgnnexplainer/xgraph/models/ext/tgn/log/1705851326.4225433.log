2024-01-21 16:35:26,424 - root - INFO - Namespace(aggregator='last', backprop_every=1, bs=200, data='wikipedia', different_new_nodes=False, drop_out=0.1, dyrep=False, embedding_module='graph_attention', gpu=0, lr=0.0001, memory_dim=172, memory_update_at_end=False, memory_updater='gru', message_dim=100, message_function='identity', n_degree=10, n_epoch=100, n_head=2, n_layer=2, n_runs=1, node_dim=100, patience=5, prefix='tgn-attn', randomize_features=False, time_dim=100, uniform=False, use_destination_embedding_in_message=False, use_memory=True, use_source_embedding_in_message=False)
2024-01-21 16:35:28,738 - root - INFO - num of training instances: 81029
2024-01-21 16:35:28,739 - root - INFO - num of batches per epoch: 406
2024-01-21 16:35:28,740 - root - INFO - start 0 epoch
2024-01-21 16:36:57,020 - root - INFO - epoch: 0 took 88.28s
2024-01-21 16:36:57,021 - root - INFO - Epoch mean loss: 0.8376360136299885
2024-01-21 16:36:57,021 - root - INFO - val auc: 0.9286027582461557, new node val auc: 0.9282402663934426
2024-01-21 16:36:57,021 - root - INFO - val ap: 0.9338585616441801, new node val ap: 0.9331850860353862
2024-01-21 16:36:57,021 - root - INFO - val acc: 0.8443047218887554, new node val acc: 0.8453483606557378
2024-01-21 16:36:57,077 - root - INFO - start 1 epoch
2024-01-21 16:38:25,036 - root - INFO - epoch: 1 took 87.99s
2024-01-21 16:38:25,036 - root - INFO - Epoch mean loss: 0.7941682921548195
2024-01-21 16:38:25,036 - root - INFO - val auc: 0.9230094840317078, new node val auc: 0.9303575819672131
2024-01-21 16:38:25,037 - root - INFO - val ap: 0.9295706462612802, new node val ap: 0.9352695389255262
2024-01-21 16:38:25,037 - root - INFO - val acc: 0.8401970788315324, new node val acc: 0.852827868852459
2024-01-21 16:38:25,090 - root - INFO - start 2 epoch
2024-01-21 16:39:52,533 - root - INFO - epoch: 2 took 87.47s
2024-01-21 16:39:52,533 - root - INFO - Epoch mean loss: 0.6945922081106402
2024-01-21 16:39:52,533 - root - INFO - val auc: 0.9264329979610892, new node val auc: 0.9348289959016394
2024-01-21 16:39:52,533 - root - INFO - val ap: 0.9336420332441235, new node val ap: 0.9409762974668215
2024-01-21 16:39:52,533 - root - INFO - val acc: 0.8397238895558222, new node val acc: 0.8548975409836066
2024-01-21 16:39:52,586 - root - INFO - start 3 epoch
2024-01-21 16:41:20,171 - root - INFO - epoch: 3 took 87.61s
2024-01-21 16:41:20,171 - root - INFO - Epoch mean loss: 0.6639378185342686
2024-01-21 16:41:20,171 - root - INFO - val auc: 0.9349208026067571, new node val auc: 0.9450397540983606
2024-01-21 16:41:20,171 - root - INFO - val ap: 0.9414848995096652, new node val ap: 0.9514692056611123
2024-01-21 16:41:20,171 - root - INFO - val acc: 0.8549769907963185, new node val acc: 0.8709016393442623
2024-01-21 16:41:20,225 - root - INFO - start 4 epoch
2024-01-21 16:42:47,789 - root - INFO - epoch: 4 took 87.59s
2024-01-21 16:42:47,789 - root - INFO - Epoch mean loss: 0.6350717653928719
2024-01-21 16:42:47,789 - root - INFO - val auc: 0.9353464600125766, new node val auc: 0.9456068647540982
2024-01-21 16:42:47,790 - root - INFO - val ap: 0.9412148716981477, new node val ap: 0.9507407155442784
2024-01-21 16:42:47,790 - root - INFO - val acc: 0.8557733093237296, new node val acc: 0.8710040983606556
2024-01-21 16:42:47,845 - root - INFO - start 5 epoch
2024-01-21 16:44:15,451 - root - INFO - epoch: 5 took 87.63s
2024-01-21 16:44:15,451 - root - INFO - Epoch mean loss: 0.6281439383041683
2024-01-21 16:44:15,451 - root - INFO - val auc: 0.9364359984469979, new node val auc: 0.9463396516393442
2024-01-21 16:44:15,451 - root - INFO - val ap: 0.9420555315315225, new node val ap: 0.952160277045779
2024-01-21 16:44:15,451 - root - INFO - val acc: 0.8554881952781112, new node val acc: 0.869938524590164
2024-01-21 16:44:15,502 - root - INFO - start 6 epoch
2024-01-21 16:45:43,135 - root - INFO - epoch: 6 took 87.66s
2024-01-21 16:45:43,136 - root - INFO - Epoch mean loss: 0.6145679631403514
2024-01-21 16:45:43,136 - root - INFO - val auc: 0.9400459700546886, new node val auc: 0.9483703893442623
2024-01-21 16:45:43,136 - root - INFO - val ap: 0.9463724826926615, new node val ap: 0.9539378016125645
2024-01-21 16:45:43,137 - root - INFO - val acc: 0.8527901160464185, new node val acc: 0.8676844262295081
2024-01-21 16:45:43,187 - root - INFO - start 7 epoch
2024-01-21 16:47:10,953 - root - INFO - epoch: 7 took 87.79s
2024-01-21 16:47:10,954 - root - INFO - Epoch mean loss: 0.5947438534991495
2024-01-21 16:47:10,954 - root - INFO - val auc: 0.9445888988928903, new node val auc: 0.9530856557377049
2024-01-21 16:47:10,954 - root - INFO - val ap: 0.9513907193351442, new node val ap: 0.9591971515046209
2024-01-21 16:47:10,954 - root - INFO - val acc: 0.8670448179271707, new node val acc: 0.8794467213114754
2024-01-21 16:47:11,011 - root - INFO - start 8 epoch
2024-01-21 16:48:38,696 - root - INFO - epoch: 8 took 87.71s
2024-01-21 16:48:38,697 - root - INFO - Epoch mean loss: 0.5850858192872531
2024-01-21 16:48:38,697 - root - INFO - val auc: 0.9435443548848113, new node val auc: 0.9499986680327869
2024-01-21 16:48:38,697 - root - INFO - val ap: 0.9501338852650353, new node val ap: 0.9561099737095577
2024-01-21 16:48:38,697 - root - INFO - val acc: 0.8666256502601042, new node val acc: 0.8746516393442625
2024-01-21 16:48:38,753 - root - INFO - start 9 epoch
2024-01-21 16:50:06,371 - root - INFO - epoch: 9 took 87.64s
2024-01-21 16:50:06,371 - root - INFO - Epoch mean loss: 0.5666825464499995
2024-01-21 16:50:06,372 - root - INFO - val auc: 0.9468460126907906, new node val auc: 0.9521030737704919
2024-01-21 16:50:06,372 - root - INFO - val ap: 0.952762514146162, new node val ap: 0.9575070145395512
2024-01-21 16:50:06,372 - root - INFO - val acc: 0.8663515406162466, new node val acc: 0.8714754098360656
2024-01-21 16:50:06,590 - root - INFO - start 10 epoch
2024-01-21 16:51:34,558 - root - INFO - epoch: 10 took 87.99s
2024-01-21 16:51:34,559 - root - INFO - Epoch mean loss: 0.5764088803177396
2024-01-21 16:51:34,559 - root - INFO - val auc: 0.9373045835000668, new node val auc: 0.9435011270491803
2024-01-21 16:51:34,559 - root - INFO - val ap: 0.9448803240445082, new node val ap: 0.9509132687828586
2024-01-21 16:51:34,559 - root - INFO - val acc: 0.85671968787515, new node val acc: 0.8632172131147541
2024-01-21 16:51:34,616 - root - INFO - start 11 epoch
2024-01-21 16:53:02,472 - root - INFO - epoch: 11 took 87.88s
2024-01-21 16:53:02,472 - root - INFO - Epoch mean loss: 0.5644157271960686
2024-01-21 16:53:02,472 - root - INFO - val auc: 0.9496041861982888, new node val auc: 0.9559860655737704
2024-01-21 16:53:02,472 - root - INFO - val ap: 0.9552675184301319, new node val ap: 0.9609632300940085
2024-01-21 16:53:02,473 - root - INFO - val acc: 0.8745558223289315, new node val acc: 0.8807377049180329
2024-01-21 16:53:02,531 - root - INFO - start 12 epoch
2024-01-21 16:54:30,269 - root - INFO - epoch: 12 took 87.76s
2024-01-21 16:54:30,270 - root - INFO - Epoch mean loss: 0.5633244253878523
2024-01-21 16:54:30,270 - root - INFO - val auc: 0.948728686950971, new node val auc: 0.953745594262295
2024-01-21 16:54:30,270 - root - INFO - val ap: 0.954099617788081, new node val ap: 0.9589785961081937
2024-01-21 16:54:30,270 - root - INFO - val acc: 0.8734963985594236, new node val acc: 0.8822131147540984
2024-01-21 16:54:30,519 - root - INFO - start 13 epoch
2024-01-21 16:55:58,443 - root - INFO - epoch: 13 took 87.95s
2024-01-21 16:55:58,443 - root - INFO - Epoch mean loss: 0.5549577914288478
2024-01-21 16:55:58,443 - root - INFO - val auc: 0.9519830591760514, new node val auc: 0.955492725409836
2024-01-21 16:55:58,443 - root - INFO - val ap: 0.957256202794313, new node val ap: 0.9608119688218537
2024-01-21 16:55:58,443 - root - INFO - val acc: 0.8788535414165668, new node val acc: 0.8840983606557375
2024-01-21 16:55:58,496 - root - INFO - start 14 epoch
2024-01-21 16:57:26,331 - root - INFO - epoch: 14 took 87.86s
2024-01-21 16:57:26,331 - root - INFO - Epoch mean loss: 0.5432338247745495
2024-01-21 16:57:26,331 - root - INFO - val auc: 0.9545522194592123, new node val auc: 0.9584904713114754
2024-01-21 16:57:26,331 - root - INFO - val ap: 0.9594277828599211, new node val ap: 0.9629860349847266
2024-01-21 16:57:26,332 - root - INFO - val acc: 0.8799559823929571, new node val acc: 0.8848975409836066
2024-01-21 16:57:26,391 - root - INFO - start 15 epoch
2024-01-21 16:58:54,191 - root - INFO - epoch: 15 took 87.83s
2024-01-21 16:58:54,192 - root - INFO - Epoch mean loss: 0.5269713023760049
2024-01-21 16:58:54,192 - root - INFO - val auc: 0.9565954343642219, new node val auc: 0.9594811475409836
2024-01-21 16:58:54,192 - root - INFO - val ap: 0.9615231106253255, new node val ap: 0.9643777467227755
2024-01-21 16:58:54,192 - root - INFO - val acc: 0.8851030412164865, new node val acc: 0.8875
2024-01-21 16:58:54,246 - root - INFO - start 16 epoch
2024-01-21 17:00:22,034 - root - INFO - epoch: 16 took 87.81s
2024-01-21 17:00:22,034 - root - INFO - Epoch mean loss: 0.5072083545142206
2024-01-21 17:00:22,034 - root - INFO - val auc: 0.9595940823948627, new node val auc: 0.9641044057377051
2024-01-21 17:00:22,034 - root - INFO - val ap: 0.9638940190160296, new node val ap: 0.9679920267568678
2024-01-21 17:00:22,034 - root - INFO - val acc: 0.8897879151660664, new node val acc: 0.8948565573770492
2024-01-21 17:00:22,592 - root - INFO - start 17 epoch
2024-01-21 17:01:50,473 - root - INFO - epoch: 17 took 87.91s
2024-01-21 17:01:50,473 - root - INFO - Epoch mean loss: 0.49140563475087357
2024-01-21 17:01:50,474 - root - INFO - val auc: 0.9604361844737895, new node val auc: 0.963424692622951
2024-01-21 17:01:50,474 - root - INFO - val ap: 0.964652071753082, new node val ap: 0.9677508278059738
2024-01-21 17:01:50,474 - root - INFO - val acc: 0.8883373349339737, new node val acc: 0.891905737704918
2024-01-21 17:01:50,528 - root - INFO - start 18 epoch
2024-01-21 17:03:18,432 - root - INFO - epoch: 18 took 87.93s
2024-01-21 17:03:18,433 - root - INFO - Epoch mean loss: 0.4998457872221623
2024-01-21 17:03:18,433 - root - INFO - val auc: 0.9602787919929876, new node val auc: 0.9630888319672132
2024-01-21 17:03:18,433 - root - INFO - val ap: 0.9649819799627292, new node val ap: 0.9676650573924158
2024-01-21 17:03:18,433 - root - INFO - val acc: 0.8869937975190074, new node val acc: 0.8910860655737706
2024-01-21 17:03:18,489 - root - INFO - start 19 epoch
2024-01-21 17:04:46,286 - root - INFO - epoch: 19 took 87.82s
2024-01-21 17:04:46,286 - root - INFO - Epoch mean loss: 0.48516911627917453
2024-01-21 17:04:46,286 - root - INFO - val auc: 0.9621761294994188, new node val auc: 0.9645868852459016
2024-01-21 17:04:46,286 - root - INFO - val ap: 0.9660587835788822, new node val ap: 0.9685532360873114
2024-01-21 17:04:46,286 - root - INFO - val acc: 0.8921298519407763, new node val acc: 0.8949795081967213
2024-01-21 17:04:46,647 - root - INFO - start 20 epoch
2024-01-21 17:06:14,633 - root - INFO - epoch: 20 took 88.01s
2024-01-21 17:06:14,633 - root - INFO - Epoch mean loss: 0.48057801639798825
2024-01-21 17:06:14,633 - root - INFO - val auc: 0.9627258112768919, new node val auc: 0.965178381147541
2024-01-21 17:06:14,633 - root - INFO - val ap: 0.9666248753175584, new node val ap: 0.9693646747742959
2024-01-21 17:06:14,633 - root - INFO - val acc: 0.8943777511004403, new node val acc: 0.8968237704918031
2024-01-21 17:06:14,976 - root - INFO - start 21 epoch
2024-01-21 17:07:42,902 - root - INFO - epoch: 21 took 87.95s
2024-01-21 17:07:42,902 - root - INFO - Epoch mean loss: 0.4704645118249461
2024-01-21 17:07:42,903 - root - INFO - val auc: 0.9645961529850035, new node val auc: 0.9640137295081966
2024-01-21 17:07:42,903 - root - INFO - val ap: 0.968451782838344, new node val ap: 0.9685333064248055
2024-01-21 17:07:42,903 - root - INFO - val acc: 0.894640856342537, new node val acc: 0.8937090163934425
2024-01-21 17:07:42,957 - root - INFO - start 22 epoch
2024-01-21 17:09:10,827 - root - INFO - epoch: 22 took 87.90s
2024-01-21 17:09:10,827 - root - INFO - Epoch mean loss: 0.4619705574999889
2024-01-21 17:09:10,827 - root - INFO - val auc: 0.9676467541778616, new node val auc: 0.9679382172131147
2024-01-21 17:09:10,827 - root - INFO - val ap: 0.9710438124577239, new node val ap: 0.9717770135158217
2024-01-21 17:09:10,827 - root - INFO - val acc: 0.8997769107643057, new node val acc: 0.8977254098360656
2024-01-21 17:09:10,882 - root - INFO - start 23 epoch
2024-01-21 17:10:38,590 - root - INFO - epoch: 23 took 87.73s
2024-01-21 17:10:38,591 - root - INFO - Epoch mean loss: 0.45454632472522155
2024-01-21 17:10:38,591 - root - INFO - val auc: 0.9658865712951846, new node val auc: 0.9656146516393442
2024-01-21 17:10:38,591 - root - INFO - val ap: 0.9697486359149864, new node val ap: 0.9699824077135841
2024-01-21 17:10:38,591 - root - INFO - val acc: 0.8909333733493398, new node val acc: 0.8903688524590164
2024-01-21 17:10:38,797 - root - INFO - start 24 epoch
2024-01-21 17:12:06,685 - root - INFO - epoch: 24 took 87.92s
2024-01-21 17:12:06,685 - root - INFO - Epoch mean loss: 0.45115297474884636
2024-01-21 17:12:06,686 - root - INFO - val auc: 0.9653738581146745, new node val auc: 0.9637585040983606
2024-01-21 17:12:06,686 - root - INFO - val ap: 0.9691992491350688, new node val ap: 0.9683226158668432
2024-01-21 17:12:06,686 - root - INFO - val acc: 0.8959743897559023, new node val acc: 0.8925614754098361
2024-01-21 17:12:06,968 - root - INFO - start 25 epoch
2024-01-21 17:13:34,800 - root - INFO - epoch: 25 took 87.86s
2024-01-21 17:13:34,800 - root - INFO - Epoch mean loss: 0.4552129239137537
2024-01-21 17:13:34,800 - root - INFO - val auc: 0.9652882946035558, new node val auc: 0.9657277663934424
2024-01-21 17:13:34,800 - root - INFO - val ap: 0.969088936492384, new node val ap: 0.9698680754822818
2024-01-21 17:13:34,800 - root - INFO - val acc: 0.8966896758703479, new node val acc: 0.8941598360655737
2024-01-21 17:13:34,856 - root - INFO - start 26 epoch
2024-01-21 17:15:02,527 - root - INFO - epoch: 26 took 87.70s
2024-01-21 17:15:02,527 - root - INFO - Epoch mean loss: 0.45684859409854917
2024-01-21 17:15:02,527 - root - INFO - val auc: 0.9660436850930848, new node val auc: 0.9686704918032787
2024-01-21 17:15:02,527 - root - INFO - val ap: 0.96977826466804, new node val ap: 0.9726370525064401
2024-01-21 17:15:02,527 - root - INFO - val acc: 0.8985264105642258, new node val acc: 0.9004098360655737
2024-01-21 17:15:02,581 - root - INFO - start 27 epoch
2024-01-21 17:16:30,329 - root - INFO - epoch: 27 took 87.77s
2024-01-21 17:16:30,330 - root - INFO - Epoch mean loss: 0.4415834486631337
2024-01-21 17:16:30,330 - root - INFO - val auc: 0.9656607538253396, new node val auc: 0.9658603483606558
2024-01-21 17:16:30,330 - root - INFO - val ap: 0.9693037182454671, new node val ap: 0.9699948272117548
2024-01-21 17:16:30,330 - root - INFO - val acc: 0.8935074029611845, new node val acc: 0.8933811475409835
2024-01-21 17:16:30,330 - root - INFO - No improvement over 5 epochs, stop training
2024-01-21 17:16:30,330 - root - INFO - Loading the best model at epoch 22
2024-01-21 17:16:30,348 - root - INFO - Loaded the best model at epoch 22 for inference
2024-01-21 17:16:54,127 - root - INFO - Test statistics: Old nodes -- auc: 0.9591821335677126, ap: 0.9632695327305912, acc: 0.8809423769507804
2024-01-21 17:16:54,127 - root - INFO - Test statistics: New nodes -- auc: 0.9523568301239946, ap: 0.9570245223301757, acc: 0.8638522476050111
2024-01-21 17:16:54,128 - root - INFO - Saving TGN model
2024-01-21 17:16:54,399 - root - INFO - TGN model saved
