2024-01-22 16:46:13,598 - root - INFO - Namespace(data='wikipedia', bs=200, prefix='tgn-attn', n_degree=10, n_head=2, n_epoch=10, n_layer=2, lr=0.0001, patience=5, n_runs=1, drop_out=0.1, gpu=0, node_dim=100, time_dim=100, backprop_every=1, use_memory=True, embedding_module='graph_attention', message_function='identity', memory_updater='gru', aggregator='last', memory_update_at_end=False, message_dim=100, memory_dim=172, different_new_nodes=False, uniform=False, randomize_features=False, use_destination_embedding_in_message=False, use_source_embedding_in_message=False, dyrep=False)
2024-01-22 16:46:15,510 - root - INFO - num of training instances: 79202
2024-01-22 16:46:15,510 - root - INFO - num of batches per epoch: 397
2024-01-22 16:46:15,511 - root - INFO - start 0 epoch
2024-01-22 16:47:37,384 - root - INFO - epoch: 0 took 81.87s
2024-01-22 16:47:37,384 - root - INFO - Epoch mean loss: 0.8237659980728284
2024-01-22 16:47:37,385 - root - INFO - val auc: 0.9215728650984203, new node val auc: 0.9142423609873613
2024-01-22 16:47:37,385 - root - INFO - val ap: 0.92695531847593, new node val ap: 0.9203318585751514
2024-01-22 16:47:37,385 - root - INFO - val acc: 0.8304161664665867, new node val acc: 0.8220350919073763
2024-01-22 16:47:37,442 - root - INFO - start 1 epoch
2024-01-22 16:48:58,280 - root - INFO - epoch: 1 took 80.87s
2024-01-22 16:48:58,280 - root - INFO - Epoch mean loss: 0.8248454545547139
2024-01-22 16:48:58,280 - root - INFO - val auc: 0.9084639458164219, new node val auc: 0.9130371195182554
2024-01-22 16:48:58,280 - root - INFO - val ap: 0.9181228151779661, new node val ap: 0.9230406320717269
2024-01-22 16:48:58,280 - root - INFO - val acc: 0.8167086834733893, new node val acc: 0.8273048460253045
2024-01-22 16:48:58,337 - root - INFO - start 2 epoch
2024-01-22 16:50:19,308 - root - INFO - epoch: 2 took 81.00s
2024-01-22 16:50:19,308 - root - INFO - Epoch mean loss: 0.7138615755049948
2024-01-22 16:50:19,308 - root - INFO - val auc: 0.9244195297166484, new node val auc: 0.9325837616712449
2024-01-22 16:50:19,309 - root - INFO - val ap: 0.9321313794449873, new node val ap: 0.939971191906797
2024-01-22 16:50:19,309 - root - INFO - val acc: 0.8430742296918767, new node val acc: 0.8525280496538553
2024-01-22 16:50:19,362 - root - INFO - start 3 epoch
2024-01-22 16:51:40,475 - root - INFO - epoch: 3 took 81.14s
2024-01-22 16:51:40,476 - root - INFO - Epoch mean loss: 0.6708946484762716
2024-01-22 16:51:40,476 - root - INFO - val auc: 0.9287808409077917, new node val auc: 0.9346264593048862
2024-01-22 16:51:40,476 - root - INFO - val ap: 0.9359423460594921, new node val ap: 0.9417514989833539
2024-01-22 16:51:40,476 - root - INFO - val acc: 0.8467717086834734, new node val acc: 0.8552590116973026
2024-01-22 16:51:40,531 - root - INFO - start 4 epoch
2024-01-22 16:53:01,371 - root - INFO - epoch: 4 took 80.87s
2024-01-22 16:53:01,372 - root - INFO - Epoch mean loss: 0.6408509259259971
2024-01-22 16:53:01,372 - root - INFO - val auc: 0.934173885268393, new node val auc: 0.9414196655223777
2024-01-22 16:53:01,372 - root - INFO - val ap: 0.9404541937745549, new node val ap: 0.9475854843226106
2024-01-22 16:53:01,372 - root - INFO - val acc: 0.8521178471388555, new node val acc: 0.8638529481976605
2024-01-22 16:53:01,423 - root - INFO - start 5 epoch
2024-01-22 16:54:22,361 - root - INFO - epoch: 5 took 80.96s
2024-01-22 16:54:22,361 - root - INFO - Epoch mean loss: 0.631141148226087
2024-01-22 16:54:22,361 - root - INFO - val auc: 0.9373903539987426, new node val auc: 0.9440636208934198
2024-01-22 16:54:22,361 - root - INFO - val ap: 0.9446570278849424, new node val ap: 0.9505417514804496
2024-01-22 16:54:22,361 - root - INFO - val acc: 0.8588095238095237, new node val acc: 0.8682710670804488
2024-01-22 16:54:22,414 - root - INFO - start 6 epoch
2024-01-22 16:55:43,389 - root - INFO - epoch: 6 took 81.00s
2024-01-22 16:55:43,389 - root - INFO - Epoch mean loss: 0.6158384282883228
2024-01-22 16:55:43,389 - root - INFO - val auc: 0.9413196378551419, new node val auc: 0.9453278680077603
2024-01-22 16:55:43,390 - root - INFO - val ap: 0.9477318842258812, new node val ap: 0.9510027577112334
2024-01-22 16:55:43,390 - root - INFO - val acc: 0.8628421368547418, new node val acc: 0.865538314633564
2024-01-22 16:55:43,442 - root - INFO - start 7 epoch
2024-01-22 16:57:04,378 - root - INFO - epoch: 7 took 80.96s
2024-01-22 16:57:04,378 - root - INFO - Epoch mean loss: 0.6081534235243233
2024-01-22 16:57:04,378 - root - INFO - val auc: 0.9403174808018446, new node val auc: 0.9439648888016569
2024-01-22 16:57:04,378 - root - INFO - val ap: 0.9466509666500434, new node val ap: 0.9495855879871968
2024-01-22 16:57:04,378 - root - INFO - val acc: 0.862158863545418, new node val acc: 0.8633558128431608
2024-01-22 16:57:04,429 - root - INFO - start 8 epoch
2024-01-22 16:58:25,425 - root - INFO - epoch: 8 took 81.02s
2024-01-22 16:58:25,425 - root - INFO - Epoch mean loss: 0.6022635536169826
2024-01-22 16:58:25,425 - root - INFO - val auc: 0.9449742689933117, new node val auc: 0.9480914854128352
2024-01-22 16:58:25,425 - root - INFO - val ap: 0.9512584793948309, new node val ap: 0.9538322590691428
2024-01-22 16:58:25,425 - root - INFO - val acc: 0.8694717887154862, new node val acc: 0.8683886369061828
2024-01-22 16:58:25,480 - root - INFO - start 9 epoch
2024-01-22 16:59:46,477 - root - INFO - epoch: 9 took 81.03s
2024-01-22 16:59:46,478 - root - INFO - Epoch mean loss: 0.580577854095238
2024-01-22 16:59:46,478 - root - INFO - val auc: 0.9484207964138038, new node val auc: 0.9504093251860171
2024-01-22 16:59:46,478 - root - INFO - val ap: 0.9542513468262371, new node val ap: 0.9557719598826037
2024-01-22 16:59:46,478 - root - INFO - val acc: 0.8710254101640655, new node val acc: 0.8697272618763426
2024-01-22 17:00:09,144 - root - INFO - Test statistics: Old nodes -- auc: 0.9343474146801578, ap: 0.9418102498477087, acc: 0.8505322128851541
2024-01-22 17:00:09,144 - root - INFO - Test statistics: New nodes -- auc: 0.9233002124480553, ap: 0.9308773232940014, acc: 0.8305983564458141
2024-01-22 17:00:09,145 - root - INFO - Saving TGN model
2024-01-22 17:00:09,437 - root - INFO - TGN model saved
