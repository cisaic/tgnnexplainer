2024-01-23 00:57:16,960 - root - INFO - Namespace(data='reddit', bs=200, prefix='tgn-attn', n_degree=10, n_head=2, n_epoch=10, n_layer=2, lr=0.0001, patience=5, n_runs=1, drop_out=0.1, gpu=0, node_dim=100, time_dim=100, backprop_every=1, use_memory=True, embedding_module='graph_attention', message_function='identity', memory_updater='gru', aggregator='last', memory_update_at_end=False, message_dim=100, memory_dim=172, different_new_nodes=False, uniform=False, randomize_features=False, use_destination_embedding_in_message=False, use_source_embedding_in_message=False, dyrep=False)
2024-01-23 00:57:23,390 - root - INFO - num of training instances: 389989
2024-01-23 00:57:23,390 - root - INFO - num of batches per epoch: 1950
2024-01-23 00:57:23,393 - root - INFO - start 0 epoch
2024-01-23 01:06:58,135 - root - INFO - epoch: 0 took 574.74s
2024-01-23 01:06:58,136 - root - INFO - Epoch mean loss: 0.48708984595078686
2024-01-23 01:06:58,136 - root - INFO - val auc: 0.9770691496319938, new node val auc: 0.9290237992361404
2024-01-23 01:06:58,136 - root - INFO - val ap: 0.9773547417925547, new node val ap: 0.9332764034902936
2024-01-23 01:06:58,136 - root - INFO - val acc: 0.9220993793409191, new node val acc: 0.8540239574090506
2024-01-23 01:06:58,195 - root - INFO - start 1 epoch
2024-01-23 01:16:31,523 - root - INFO - epoch: 1 took 573.36s
2024-01-23 01:16:31,523 - root - INFO - Epoch mean loss: 0.40224142107443933
2024-01-23 01:16:31,523 - root - INFO - val auc: 0.9799625079843137, new node val auc: 0.9457436492129934
2024-01-23 01:16:31,524 - root - INFO - val ap: 0.9802704724723236, new node val ap: 0.9493035830159618
2024-01-23 01:16:31,524 - root - INFO - val acc: 0.9279755430766956, new node val acc: 0.8737455634427683
2024-01-23 01:16:31,578 - root - INFO - start 2 epoch
2024-01-23 01:26:07,516 - root - INFO - epoch: 2 took 575.97s
2024-01-23 01:26:07,517 - root - INFO - Epoch mean loss: 0.3698157964914273
2024-01-23 01:26:07,517 - root - INFO - val auc: 0.9787614145138059, new node val auc: 0.933103913332819
2024-01-23 01:26:07,517 - root - INFO - val ap: 0.9793336141013059, new node val ap: 0.9378316005801529
2024-01-23 01:26:07,517 - root - INFO - val acc: 0.9263865080537905, new node val acc: 0.8574767080745341
2024-01-23 01:26:07,572 - root - INFO - start 3 epoch
2024-01-23 01:35:43,353 - root - INFO - epoch: 3 took 575.81s
2024-01-23 01:35:43,354 - root - INFO - Epoch mean loss: 0.4994028893800882
2024-01-23 01:35:43,354 - root - INFO - val auc: 0.9705108947724802, new node val auc: 0.9103041363662667
2024-01-23 01:35:43,354 - root - INFO - val ap: 0.9712571761985316, new node val ap: 0.9139361597928152
2024-01-23 01:35:43,354 - root - INFO - val acc: 0.9083571745234225, new node val acc: 0.8313043478260868
2024-01-23 01:35:43,407 - root - INFO - start 4 epoch
2024-01-23 01:45:17,387 - root - INFO - epoch: 4 took 574.01s
2024-01-23 01:45:17,387 - root - INFO - Epoch mean loss: 0.5492979897596897
2024-01-23 01:45:17,388 - root - INFO - val auc: 0.9609363032793032, new node val auc: 0.9241550641854095
2024-01-23 01:45:17,388 - root - INFO - val ap: 0.9623571397284107, new node val ap: 0.9276038157177154
2024-01-23 01:45:17,388 - root - INFO - val acc: 0.8889859612826954, new node val acc: 0.8483451641526176
2024-01-23 01:45:17,438 - root - INFO - start 5 epoch
2024-01-23 01:54:49,545 - root - INFO - epoch: 5 took 572.13s
2024-01-23 01:54:49,545 - root - INFO - Epoch mean loss: 0.5299515684445699
2024-01-23 01:54:49,545 - root - INFO - val auc: 0.9678948799209951, new node val auc: 0.9391679268257397
2024-01-23 01:54:49,545 - root - INFO - val ap: 0.9696939276712105, new node val ap: 0.9446677400038979
2024-01-23 01:54:49,545 - root - INFO - val acc: 0.9045996010048767, new node val acc: 0.8708895297249336
2024-01-23 01:54:49,596 - root - INFO - start 6 epoch
2024-01-23 02:04:19,900 - root - INFO - epoch: 6 took 570.33s
2024-01-23 02:04:19,900 - root - INFO - Epoch mean loss: 0.4956612349167848
2024-01-23 02:04:19,901 - root - INFO - val auc: 0.9673870298242789, new node val auc: 0.9223755798869642
2024-01-23 02:04:19,901 - root - INFO - val ap: 0.9685238313151305, new node val ap: 0.928385253551797
2024-01-23 02:04:19,901 - root - INFO - val acc: 0.9039214570710802, new node val acc: 0.8498691215616684
2024-01-23 02:04:19,901 - root - INFO - No improvement over 5 epochs, stop training
2024-01-23 02:04:19,901 - root - INFO - Loading the best model at epoch 1
2024-01-23 02:04:19,925 - root - INFO - Loaded the best model at epoch 1 for inference
2024-01-23 02:07:02,490 - root - INFO - Test statistics: Old nodes -- auc: 0.9794963183270878, ap: 0.9791299324693126, acc: 0.9253029407418354
2024-01-23 02:07:02,491 - root - INFO - Test statistics: New nodes -- auc: 0.9580770006613756, ap: 0.9572846660076089, acc: 0.8839847883597884
2024-01-23 02:07:02,492 - root - INFO - Saving TGN model
2024-01-23 02:07:02,948 - root - INFO - TGN model saved
